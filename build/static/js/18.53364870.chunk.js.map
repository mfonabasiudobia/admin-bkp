{"version":3,"sources":["app/components/agentManagement/Allagent.js"],"names":["Allagent","agents","setAgents","useState","loading","setLoading","pageNumber","setPageNumber","numberOfPages","setNumberOfPages","limit","setLimit","searchList","setSearchList","searchType","setSearchType","baseUrl","process","maskPhoneNumber","phone","phoneStr","toString","length","concat","slice","getAllAgents","async","access_token","localStorage","getItem","headers","Authorization","response","axios","get","data","totalPages","error","console","log","useEffect","_jsx","className","style","height","children","role","_Fragment","_jsxs","backgroundColor","id","name","onChange","e","target","value","type","placeholder","event","key","map","agent","_id","Name","href","Phone","referral_code","commission_percentage","user_type","onClick","window","confirm","userType","post","then","res","alert","catch","blockAgent","Link","to","ReactPaginate","previousLabel","nextLabel","breakLabel","pageCount","marginPagesDisplayed","pageRangeDisplayed","onPageChange","currentPage","selected","containerClassName","pageClassName","pageLinkClassName","previousClassName","previousLinkClassName","nextClassName","nextLinkClassName","breakClassName","breakLinkClassName","activeClassName"],"mappings":"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","file":"static/js/18.53364870.chunk.js","sourcesContent":["import axios from 'axios'\nimport React, { useEffect, useState } from 'react'\nimport { Link } from 'react-router-dom'\nimport ReactPaginate from 'react-paginate'\n\nexport default function Allagent() {\n\n    const [agents, setAgents] = useState([])\n    const [loading, setLoading] = useState(true)\n    \n    // Pagination states\n    const [pageNumber, setPageNumber] = useState(0)\n    const [numberOfPages, setNumberOfPages] = useState(0)\n    const [limit, setLimit] = useState(10)\n    \n    // Search states\n    const [searchList, setSearchList] = useState(\"\")\n    const [searchType, setSearchType] = useState(\"0\")\n    \n    const beckendLocalApiUrl = process.env.REACT_APP_BACKEND_LOCAL_API;\n    const beckendLiveApiUrl = process.env.REACT_APP_BACKEND_LIVE_API;\n    const nodeMode = process.env.NODE_ENV;\n    if (nodeMode === \"development\") {\n      var baseUrl = beckendLocalApiUrl;\n    } else {\n      baseUrl = beckendLiveApiUrl;\n    }\n\n    // Phone number masking function\n    const maskPhoneNumber = (phone) => {\n        if (!phone) return \"\";\n        const phoneStr = phone.toString();\n        if (phoneStr.length >= 10) {\n            return `91${phoneStr.slice(2, -2)}XX${phoneStr.slice(-2)}`;\n        }\n        return phoneStr;\n    }\n\n    // Pagination handler\n    const handlePageClick = async (data) => {\n        let currentPage = data.selected + 1;\n        setPageNumber(currentPage);\n    }\n\n    // Search handler\n    const searchHandler = (event) => {\n        let key = event.target.value\n        setSearchList(key);\n    }\n\n    // Set page limit\n    const setpageLimit = (event) => {\n        let key = event.target.value\n        setLimit(key);\n    }\n\n    const getAllAgents = async () => {\n        try {\n            setLoading(true)\n            const access_token = localStorage.getItem('token')\n            const headers = {\n                Authorization: `Bearer ${access_token}`\n            }\n            \n            const response = await axios.get(\n                baseUrl + `agent/all?page=${pageNumber}&_limit=${limit}&_q=${searchList}&_stype=${searchType}`, \n                { headers }\n            )\n            \n            setAgents(response.data.agents || response.data)\n            setNumberOfPages(response.data.totalPages || 1)\n            setLoading(false)\n        } catch (error) {\n            console.log(error);\n            setLoading(false)\n        }\n    }\n\n    const blockAgent = (agent) => {\n        const confirmBox = window.confirm(`Are you sure you want to block ${agent.Name}?`);\n        if (confirmBox === true) {\n            const access_token = localStorage.getItem(\"token\")\n            const headers = {\n                Authorization: `Bearer ${access_token}`\n            }\n            const userType = agent.user_type === 'Block' ? 'Agent' : 'Block';\n            \n            axios.post(baseUrl + `block/user/${agent._id}`, { user_type: userType }, { headers })\n                .then((res) => {\n                    getAllAgents()\n                    alert(\"Agent status updated successfully!\");\n                })\n                .catch((error) => {\n                    console.log(error);\n                    alert(\"Error updating agent status\");\n                })\n        }\n    }\n\n    useEffect(() => {\n        getAllAgents()\n    }, [pageNumber, limit, searchList, searchType])\n\n    if (loading) {\n        return (\n            <div className=\"d-flex justify-content-center align-items-center\" style={{height: \"50vh\"}}>\n                <div className=\"spinner-border text-light\" role=\"status\">\n                    <span className=\"sr-only\">Loading...</span>\n                </div>\n            </div>\n        )\n    }\n\n    return (\n        <>\n            {/* <h4 className='text-uppercase font-weight-bold my-3'>all Agents list</h4> */}\n            <div className=\"row bg-dark\">\n                <div className=\"col-12 grid-margin\">\n                    <div className=\"card bg-dark\">\n                        <div className=\"card-body text-light\" style={{backgroundColor:\"rgba(0, 27, 11, 0.734)\"}}>\n                            <h4 className=\"card-title text-light\">All Agents List</h4>\n                            \n                            {/* Search and Filter Section */}\n                            <div className='row mb-3'>\n                                <select \n                                    className='form-control col-sm-3 m-2' \n                                    id='searchType' \n                                    name='searchtype' \n                                    onChange={(e) => setSearchType(e.target.value)}\n                                >\n                                    <option value=\"0\">Select Search by</option>\n                                    <option value=\"Name\">Name</option>\n                                    <option value=\"Phone\">Phone</option>\n                                    <option value=\"_id\">Agent ID</option>\n                                </select>\n                                <input \n                                    type='text' \n                                    placeholder='Search...' \n                                    className='form-control col-sm-4 m-2' \n                                    onChange={searchHandler} \n                                />\n                                <select \n                                    className='form-control col-sm-2 m-2 bg-dark text-light' \n                                    id='pagelimit' \n                                    name='pagelimit' \n                                    onChange={setpageLimit}\n                                >\n                                    <option value=\"10\">10</option>\n                                    <option value=\"20\">20</option>\n                                    <option value=\"50\">50</option>\n                                    <option value=\"100\">100</option>\n                                </select>\n                            </div>\n\n                            <div className=\"table-responsive\">\n                                <table className=\"table\">\n                                    <thead>\n                                        <tr>\n                                            <th>#</th>\n                                            <th>ID</th>\n                                            <th>Name</th>\n                                            <th>Mobile</th>\n                                            <th>Referral Code</th>\n                                            <th>Commission (%)</th>\n                                            <th>Status</th>\n                                            <th>Actions</th>\n                                        </tr>\n                                    </thead>\n                                    {agents && agents.map((agent, key) => (\n                                        <tbody key={agent._id}>\n                                            <tr>\n                                                <td>{key + 1}</td>\n                                                <td>{agent._id}</td>\n                                                <td>\n                                                    <span className=\"pl-2\">{agent.Name}</span>\n                                                </td>\n                                                <td>\n                                                    <a \n                                                        className=\"cxy flex-column\" \n                                                        href={`https://api.whatsapp.com/send?phone=+91${agent.Phone}&text=Hello`}\n                                                    >\n                                                        {maskPhoneNumber(agent.Phone)}\n                                                    </a>\n                                                </td>\n                                                <td>{agent.referral_code || \"N/A\"}</td>\n                                                <td>{agent.commission_percentage || 10}%</td>\n                                                <td>\n                                                    <div className=\"badge badge-outline-success\">Active</div>\n                                                </td>\n                                                <td>\n                                                    <button \n                                                        type='button' \n                                                        className={`btn mx-1 ${agent.user_type === 'Block' ? 'btn-success' : 'btn-danger'}`} \n                                                        onClick={() => blockAgent(agent)}\n                                                    >\n                                                        {agent.user_type === \"Block\" ? \"Unblock\" : \"Block\"}\n                                                    </button>\n                                                    <Link \n                                                        type='button' \n                                                        className=\"btn btn-outline-info mx-1\" \n                                                        to={`/agent/edit/${agent._id}`}\n                                                    >\n                                                        Edit\n                                                    </Link>\n                                                    <Link \n                                                        type='button' \n                                                        className=\"btn btn-outline-info mx-1\" \n                                                        to={`/agent/permissions/${agent._id}`}\n                                                    >\n                                                        Grant Permission\n                                                    </Link>\n                                                </td>\n                                            </tr>\n                                        </tbody>\n                                    ))}\n                                </table>\n                            </div>\n\n                            {/* Pagination */}\n                            {numberOfPages > 1 && (\n                                <div className='mt-4'>\n                                    <ReactPaginate\n                                        previousLabel={\"Previous\"}\n                                        nextLabel={\"Next\"}\n                                        breakLabel={\"...\"}\n                                        pageCount={numberOfPages}\n                                        marginPagesDisplayed={2}\n                                        pageRangeDisplayed={3}\n                                        onPageChange={handlePageClick}\n                                        containerClassName={\"pagination justify-content-center\"}\n                                        pageClassName={\"page-item\"}\n                                        pageLinkClassName={\"page-link\"}\n                                        previousClassName={\"page-item\"}\n                                        previousLinkClassName={\"page-link\"}\n                                        nextClassName={\"page-item\"}\n                                        nextLinkClassName={\"page-link\"}\n                                        breakClassName={\"page-item\"}\n                                        breakLinkClassName={\"page-link\"}\n                                        activeClassName={\"active\"}\n                                    />\n                                </div>\n                            )}\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </>\n    )\n}\n"],"sourceRoot":""}